package main.java.tree;

public class TreeToCircularList {
	/**
	 * left contain previous and right pointer contains next
	 * 
	 * @param left
	 * @param right
	 * @return
	 */
	public static TreeNode<Integer> concatenateTwoCircularList(TreeNode<Integer> leftList,
			TreeNode<Integer> rightList) {
		if (null == leftList)
			return rightList;
		if (null == rightList)
			return leftList;
		// get the last node of left list since its a circular list
		TreeNode<Integer> leftLast = leftList.getLeft();
		// get the last node of right list since its a circular list
		TreeNode<Integer> rightLast = rightList.getLeft();

		leftLast.setRight(rightList);
		rightList.setLeft(leftLast);
		rightLast.setRight(leftList);
		leftList.setLeft(rightLast);
		return leftList;

	}

	/**
	 * algo 1.make a general concatenate function to concatenate two list in to
	 * one 2.convert left tree to list 3.convert right tree to list
	 * 4.concatenate left with root and then with right
	 * 
	 * @param root
	 * @return
	 */
	public static TreeNode<Integer> convertTreeToCircularList(TreeNode<Integer> root) {
		if (null == root)
			return null;
		TreeNode<Integer> left = convertTreeToCircularList(root.getLeft());
		TreeNode<Integer> right = convertTreeToCircularList(root.getRight());

		root.setLeft(root);
		root.setRight(root);

		return concatenateTwoCircularList(concatenateTwoCircularList(left, root), right);
	}

	public static void printCircular(TreeNode<Integer> root) {
		TreeNode<Integer> current = root.getRight();
		System.out.print(root.getData() + "-->");
		while (!root.getData().equals(current.getData())) {
			System.out.print(current.getData() + "-->");
			current = current.getRight();
		}
	}

	/**
	 * algo for doubly list is simple 1.fix left pointesr we traverse the
	 * inorder way and keep track the previously visited node then make all left
	 * to points it 2.now fix right pointers for that we take help of first step
	 * since all left nodes are fixed we traverse the whole list and fix the
	 * right pointers we start from right most node of the tree bcz this would
	 * be the last node of list
	 * 
	 * @param root
	 * @return
	 */
	public static TreeNode<Integer> convertTreeToDoublyList(TreeNode<Integer> root) {
		if (null == root)
			return null;
		fixLeftPointers(root, null);
		fixRightPoinetrs(root);

		return root;
	}

	private static void fixRightPoinetrs(TreeNode<Integer> root) {
		TreeNode<Integer> node=root.getRight();
		while(null !=node && node.getRight() != null)
			node = node.getRight();
		while(node.getLeft()!=null){
			TreeNode<Integer> left =node.getLeft();
			left.setRight(node);
			node=node.getLeft();
		}
		
	}

	private static void fixLeftPointers(TreeNode<Integer> root, TreeNode<Integer> previous) {
		fixLeftPointers(root.getLeft(), previous);
		root.setLeft(previous);
		previous = root;
		fixLeftPointers(root.getRight(), previous);

	}

	public static void main(String[] args) {
		TreeNode<Integer> root = new TreeNode<Integer>(1);
		root.setLeft(new TreeNode<Integer>(2));
		root.setRight(new TreeNode<Integer>(3));
		root.getLeft().setLeft(new TreeNode<Integer>(4));
		root.getLeft().setRight(new TreeNode<Integer>(5));
		root.getRight().setLeft(new TreeNode<Integer>(6));
		root.getRight().setRight(new TreeNode<Integer>(7));
		BinaryTree<Integer> tree = new BinaryTree<Integer>(root);

		System.out.println(tree);
		printCircular(convertTreeToCircularList(root));
	}
}
